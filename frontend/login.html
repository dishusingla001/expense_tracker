<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login</title>
    <link rel="icon" type="image/png" href="android-chrome-512x512.png">
    <link rel="icon" type="image/png" href="Moneynew_logo-removebg-preview.png">
    <link rel="stylesheet" href="login.css">
</head>

<body>
    <div class="container">
        <div class="form-box">
            <h2>Login</h2>
            <form id="loginForm">
                <div class="input-group">
                    <input type="email"  name="email" id="email" placeholder="Email" required>

                    <i class="fas fa-envelope"></i>
                </div>
                <div class="input-group">
                    <input type="password" id="password" name="password" placeholder="Password" required>

                    <i class="fa-solid fa-lock"></i>
                </div>


                <button type="submit" class="submit-btn">Login</button>
                <p class="switch-page">Don't have an account? <a href="signup.html">Sign Up</a></p>

                <script src="https://kit.fontawesome.com/d077a0e0a8.js"></script>
            </form>

            <script>
                document.getElementById('loginForm').addEventListener('submit', async function (e) {
                    e.preventDefault();
            
                    const formData = new FormData(this);
                    const data = new URLSearchParams(formData);
            
                    const response = await fetch('https://expense-tracker-delta-ruddy-29.vercel.app/login', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/x-www-form-urlencoded'
                        },
                        body: data
                    });
            
                    const text = await response.text();
            
                    if (text === 'success') {
                        localStorage.setItem('isLoggedIn', 'true');
                        localStorage.setItem('userEmail', document.getElementById('email').value); // optional
                        window.location.href = 'index.html';
                    } else {
                        alert('Invalid email or password'); // show error popup
                    }
                });
            </script>
            
        </div>
    </div>
</body>

</html>